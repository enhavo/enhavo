define(['jquery', 'app/Admin', 'app/Router', 'app/Form'], function($, admin, router, form) {
    function SearchForm()
    {
        var self = this;

        this.init = function () {

            form.initRadioAndCheckbox('#search_form');

            jQuery('#search_form').on('submit', function (event) {
                event.preventDefault();
                var form = jQuery(this);
                var url = jQuery(this).attr('action');
                var data = jQuery(this).serialize();
                jQuery.ajax({
                    url: url,
                    type: 'POST',
                    data: data,
                    success: function(response) {
                        jQuery('#search-results').remove();
                        jQuery(response).insertAfter(form);
                        self.initResults();
                    },
                    error: function(response) {
                        console.log("Search error.")
                    }
                });
                return false;
            });

            jQuery("[data-show-search-options]").on("click", function(event) {
                event.preventDefault();
                jQuery("[data-search-options]").fadeToggle(300);
            })
        };

        this.initResults = function() {
            jQuery('#search-results').on('click', '[data-id]', function() {
                var id = jQuery(this).data('id');
                var url = jQuery(this).data('url');
                admin.ajaxOverlay(url);
            });
        };

        this.init();
    }

    return new SearchForm();
});