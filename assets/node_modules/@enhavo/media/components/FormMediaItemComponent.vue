<template>
    <div class="form-list-item" ref="element">
        <img v-if="isImage(form.file)" :src="form.path('enhavoPreviewThumb')" />
        <div v-else><span :class="'icon_'+getIcon(form.file)"></span></div>

        <ul class="form-list-item-buttons-row" v-if="sortable || deletable">
            <li v-if="sortable" class="form-list-item-buttons-button drag-button"><i class="icon icon-drag">=</i></li>
            <li  v-if="deletable" class="form-list-item-buttons-button" @click="$emit('delete', form)"><i class="icon icon-close">x</i></li>
        </ul>
        <div class="form-list-item-label" v-if="blockName">{{ blockName }}</div>
        <form-widget :form="form" />
    </div>
</template>

<script setup lang="ts">
import {MediaItemForm} from "@enhavo/media/form/model/MediaItemForm";
import {useUpdateElement} from "@enhavo/vue-form/composable/form";
import {MediaUtil} from "@enhavo/media/form/MediaUtil";

const props = defineProps<{
    form: MediaItemForm,
    sortable: boolean,
    deletable: boolean,
    blockName: string,
}>()

useUpdateElement(props.form);

function isImage(file: File): boolean
{
    return MediaUtil.isImage(this.form.file);
}

function getIcon(file: File): string
{
    return MediaUtil.getIcon(this.form.file);
}

</script>
