services:

    Enhavo\Bundle\NewsletterBundle\Client\CleverReachClient:
        arguments:
            - '@event_dispatcher'

    Enhavo\Bundle\NewsletterBundle\Client\MailChimpClient: ~

    enhavo_newsletter.add_subscriber_listener:
        class: Enhavo\Bundle\NewsletterBundle\EventListener\SubscriberSubscriber
        arguments:
            - '@enhavo_newsletter.form_resolver'
        tags:
            - { name: kernel.event_subscriber }

    enhavo_newsletter.form_resolver:
        public: true
        class: Enhavo\Bundle\NewsletterBundle\Form\Resolver
        arguments:
            - '%enhavo_newsletter.forms%'
            - '_enhavo_newsletter.default_groups_'
            - '@enhavo_newsletter.group_manager'

    enhavo_newsletter.group_manager:
        class: Enhavo\Bundle\NewsletterBundle\Group\GroupManager
        arguments:
            - '@doctrine.orm.entity_manager'

    enhavo_newsletter.subscriber_exists_validator:
        class: Enhavo\Bundle\NewsletterBundle\Validator\Constraints\SubscriberExistsValidator
        arguments:
            - '@Enhavo\Bundle\NewsletterBundle\Subscriber\SubscriberManager'
        tags:
            - { name: validator.constraint_validator, alias: subscriber_exists }

    Enhavo\Bundle\NewsletterBundle\Menu\NewsletterMainMenu:
        parent: Enhavo\Bundle\AppBundle\Menu\Menu\ListMenu
        tags:
            - { name: enhavo.menu, alias: newsletter }

    Enhavo\Bundle\NewsletterBundle\Action\SendActionType:
        public: true
        arguments:
            - '@translator'
        tags:
            - { name: enhavo.action, alias: newsletter_send }

    Enhavo\Bundle\NewsletterBundle\Action\SendTestActionType:
        public: true
        arguments:
            - '@translator'
        tags:
            - { name: enhavo.action, alias: newsletter_send_test }

    Enhavo\Bundle\NewsletterBundle\Action\StatsActionType:
        public: true
        arguments:
            - '@translator'
            - '@router'
        tags:
            - { name: enhavo.action, alias: newsletter_stats }

    Enhavo\Bundle\NewsletterBundle\Block\SubscribeBlockType:
        tags:
            - { name: enhavo_block.block }
